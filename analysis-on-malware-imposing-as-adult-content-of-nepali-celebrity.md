---
title: "Analysis on malware imposing as adult content of Nepali celebrity"
date: 2023-03-20T00:00:00+05:45
# post image
image: "/images/blog/analysis-on-malware-imposing-as-adult-content-of-nepali-celebrity/cover.png"
# author
author: "Venus Chhantel"
# post type (regular/featured)
type: "featured"
# meta description
description: "In the recent event of time, there has been increase in scam and malware incidents in Nepal. As a security analyst with prime interest in malware, I carried out my research. During my investigation, I came across a Facebook page, named Stock Trading Nepal. This page appeared to be offering information and resources related to stock trading. But was distributing malware and scamming people. This page was recently created on Dec 9, 2022, and is still active."
# post draft
draft: false
---

{{< toc >}}

## Background

In the recent month, there is misinformation circulating concerning leaks of private video of Nepali female celebrities. Following the Twitter thread from [milann shrestha:](https://twitter.com/milannshrestga/status/1631537194769973249)

I found that the misinformation of private videos of Nepali celebrities being leaked were shared and advertised via some impersonated Facebook pages of major news sources of Nepal. This impersonation was done using puny code to make it seem similar to genuine for naked eyes.

{{< image src="/images/blog/analysis-on-malware-imposing-as-adult-content-of-nepali-celebrity/1.jpg" caption="" alt="" height="" width="" position="center" command="fit" option="" class="img-fluid" title="" >}}

The real intent behind all this was to distribute password stealing malware. The malware samples imposing leaked private video of multiple Nepali female celebrities can be found below:

[MalwareBazaar | SHA256 ae35a789f61e377dc715b0695b985d399dbcfe1650f0f10fe0ea40343fc4f0f8 (abuse.ch)](https://bazaar.abuse.ch/sample/ae35a789f61e377dc715b0695b985d399dbcfe1650f0f10fe0ea40343fc4f0f8#file_info)

[MalwareBazaar | SHA256 d2a06c261eb6864cbda29fdf43d89a167de67b1c585affa83e9852f91275ab28 (abuse.ch)](https://bazaar.abuse.ch/sample/d2a06c261eb6864cbda29fdf43d89a167de67b1c585affa83e9852f91275ab28/)


## Analysis
I started my analysis with the malware sample which was imposing as private video leak of Swastima Khadka. There was a zipped file shared on drive, which on extracting included 2 files. The file icons were modified to that of a video. Additionally, the file name is lengthy with unnecessary digits possibly to hide the ‘.exe’ extension since typical users may not look at type as application. This may lead to user execution of the malware just because of video icon.

{{< image src="/images/blog/analysis-on-malware-imposing-as-adult-content-of-nepali-celebrity/2.jpg" caption="" alt="" height="" width="" position="center" command="fit" option="" class="img-fluid" title="" >}}

Both of the above file had exact same size. So, they could be the same file. On checking the MD5 hash of both of the file above, the hash matched and can be deduced that they were both the same file.

{{< image src="/images/blog/analysis-on-malware-imposing-as-adult-content-of-nepali-celebrity/3.jpg" caption="cdca39597011ef4a3c57326d31674b4d" alt="cdca39597011ef4a3c57326d31674b4d" height="" width="" position="center" command="fit" option="" class="img-fluid" title="cdca39597011ef4a3c57326d31674b4d" >}}

On checking the headers of the executable using PEview tool, it was found that this malware was compiled on 27th Feb of 2023.

{{< image src="/images/blog/analysis-on-malware-imposing-as-adult-content-of-nepali-celebrity/4.jpg" caption="" alt="" height="" width="" position="center" command="fit" option="" class="img-fluid" title="" >}}

I then fire up ProcMon tool and executed this malware in my own isolated virtual environment to understand the behavior of the malware. Here, I found that the malware was making network connection to 167[.]179[.]66[.]121:1337.

{{< image src="/images/blog/analysis-on-malware-imposing-as-adult-content-of-nepali-celebrity/5.jpg" caption="167[.]179[.]66[.]121:1337 & vultrusercontent[.]com" alt="" height="" width="" position="center" command="fit" option="" class="img-fluid" title="167[.]179[.]66[.]121:1337 & vultrusercontent[.]com" >}}

Furthermore, on checking the IP address 167[.]179[.]66[.]121 over VirusTotal, I found that this IP is associated to other possible malicious file that were also imposing as adult content and others. So, it is clear that this threat actor tries to lure its victim by imposing adult contents.

{{< image src="/images/blog/analysis-on-malware-imposing-as-adult-content-of-nepali-celebrity/6.jpg" caption="" alt="" height="" width="" position="center" command="fit" option="" class="img-fluid" title="" >}}

Now back to ProcMon tool, it was also found that the malware accessed the data stored by the browser. The malware accessed the default user’s cookies and login data of the Chrome browser from %LOCALAPPDATA%\Google\Chrome\User Data.

{{< image src="/images/blog/analysis-on-malware-imposing-as-adult-content-of-nepali-celebrity/7.jpg" caption="" alt="" height="" width="" position="center" command="fit" option="" class="img-fluid" title="" >}}

Wireshark was used to capture all the network traffic of the malware during the execution. I looked up for the above IP address 167[.]179[.]66[.]121 found in ProcMon. There it can be seen that the malware was communicating with that IP address over port 1337.

{{< image src="/images/blog/analysis-on-malware-imposing-as-adult-content-of-nepali-celebrity/8.jpg" caption="" alt="" height="" width="" position="center" command="fit" option="" class="img-fluid" title="" >}}

First the malware can be seen contacting the C2 server (hxxp://167[.]179[.]66[.]121[:]1337/api/setting) with GET method to get configuration. Then the malware exfiltrated the browser data containing cookie and password, along with the IP data through POST method in JSON as shown below.

{{< image src="/images/blog/analysis-on-malware-imposing-as-adult-content-of-nepali-celebrity/9.jpg" caption="" alt="" height="" width="" position="center" command="fit" option="" class="img-fluid" title="" >}}

This verifies that it is a password stealer malware targeting the browsers.


## MITRE ATT&CK TTP
{{< image src="/images/blog/analysis-on-malware-imposing-as-adult-content-of-nepali-celebrity/10.jpg" caption="" alt="" height="" width="" position="center" command="fit" option="" class="img-fluid" title="" >}}


## Further Findings
The second malware sample which was imposing as private video leak of Nisha Adhikari, also used the similar TTP as covered above. But, the only difference was the IP address of its C2 server, which was 149[.]28[.]150[.]40.

## Indicator of Compromise (IoC)
{{< image src="/images/blog/analysis-on-malware-imposing-as-adult-content-of-nepali-celebrity/11.jpg" caption="" alt="" height="" width="" position="center" command="fit" option="" class="img-fluid" title="" >}}

## Recommendations
-  Do not download files from untrusted source.
-   Use updated antivirus.
-   Update all the password stored in the infected machine and implement multiple factor authentication.
-   Destroy all web session cookies.